<app-navbar [mostrarBusqueda]="false"></app-navbar>


<div class="container mt-4" *ngIf="!loading && pelicula; else noPelicula">
  <h2 class="mb-4">{{ pelicula.Title }}</h2>
  <div class="row">
    <div class="col-md-4">
      <img [src]="pelicula.Poster" class="img-fluid" alt="Poster de {{pelicula.Title}}">
    </div>
    <div class="col-md-8">
      <p><strong>Año:</strong> {{ pelicula.Year }}</p>
      <p><strong>Género:</strong> {{ pelicula.Type }}</p>
      <p><strong>Cine:</strong> {{ pelicula.Ubication }}</p>
      <p>{{ pelicula.description }}</p>
      <span class="badge mt-2" [ngClass]="pelicula.Estado ? 'bg-success' : 'bg-danger'">
        {{ pelicula.Estado ? 'Disponible' : 'No Disponible' }}
      </span>

      <div class="mt-4">
        <button class="btn btn-warning me-2" (click)="abrirModalActualizar()">Actualizar</button>
        <button class="btn btn-danger" (click)="abrirModalEliminar()">Eliminar</button>
      </div>
    </div>
  </div>
</div>

<ng-template #noPelicula>
  <div class="text-center">
    <p>Película no encontrada.</p>
  </div>
</ng-template>

<!-- Modal Actualizar -->
<div *ngIf="mostrarModalActualizar && pelicula" 
     class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center p-2"
     style="background: rgba(0,0,0,0.5); z-index:1050;">

  <div class="modal-dialog modal-dialog-centered modal-xl w-100" style="max-width: 900px;">
    <div class="modal-content shadow-lg rounded-3" style="background-color: #ffffff;">
      <div class="modal-header bg-primary text-white rounded-top">
        <h5 class="modal-title">Actualizar Película</h5>
        <button type="button" class="btn-close btn-close-white" (click)="cerrarModal()"></button>
      </div>

      <div class="modal-body">
        <form #formActualizar="ngForm" class="row g-3">
          <div class="col-12 col-md-6">
            <label class="form-label fw-bold">Título</label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="pelicula.Title" name="title" placeholder="Ingrese el título">
          </div>

          <div class="col-12 col-md-6">
            <label class="form-label fw-bold">Año</label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="pelicula.Year" name="year">
          </div>

          <div class="col-12">
            <label class="form-label fw-bold">Descripción</label>
            <textarea class="form-control form-control-lg" [(ngModel)]="pelicula.description" name="description" rows="4" placeholder="Ingrese la descripción"></textarea>
          </div>

          <div class="col-12 col-md-6">
            <label class="form-label fw-bold">Género</label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="pelicula.Type" name="type">
          </div>

          <div class="col-12 col-md-6">
            <label class="form-label fw-bold">Cine / Ubicación</label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="pelicula.Ubication" name="ubication">
          </div>

          <div class="col-12 col-md-6">
            <label class="form-label fw-bold">Estado</label>
            <select class="form-select form-select-lg" [(ngModel)]="pelicula.Estado" name="estado">
              <option [value]="true">Disponible</option>
              <option [value]="false">No Disponible</option>
            </select>
          </div>

          <div class="col-12 col-md-6">
            <label class="form-label fw-bold">URL del Poster</label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="pelicula.Poster" name="poster" placeholder="Ingrese la URL del poster">
          </div>
        </form>
      </div>

      <div class="modal-footer justify-content-center gap-3">
        <button class="btn btn-secondary px-4" (click)="cerrarModal()">Cancelar</button>
        <button class="btn btn-success px-4" (click)="actualizar()">Guardar</button>
      </div>
    </div>
  </div>
</div>



<!-- Modal Eliminar -->
<div *ngIf="mostrarModalEliminar && pelicula" 
     class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center p-2"
     style="background: rgba(0,0,0,0.5); z-index:1050;">

  <div class="modal-dialog modal-dialog-centered modal-lg w-100" style="max-width: 600px;">
    <div class="modal-content shadow-lg rounded-3" style="background-color: #ffffff;">
      <div class="modal-header bg-danger text-white rounded-top">
        <h5 class="modal-title">Eliminar Película</h5>
        <button type="button" class="btn-close btn-close-white" (click)="cerrarModal()"></button>
      </div>
      <div class="modal-body">
        <p class="fs-5 text-center">¿Seguro que deseas eliminar <strong>{{pelicula.Title}}</strong>?</p>
      </div>
      <div class="modal-footer justify-content-center gap-3">
        <button class="btn btn-secondary px-4" (click)="cerrarModal()">Cancelar</button>
        <button class="btn btn-danger px-4" (click)="eliminar()">Eliminar</button>
      </div>
    </div>
  </div>
</div>



<app-footer></app-footer>
